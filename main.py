import tensorflow as tf
import tensorflow_hub as hub

import numpy as np
import matplotlib.pyplot as plt
from PIL import Image as image # althought we installed pillow, but we import as pil
import wget

#download pretrained model from tensorflow_hub
pretrained_model = hub.KerasLayer("https://tfhub.dev/google/imagenet/mobilenet_v2_130_224/classification/5")

#create model object
model = tf.keras.models.Sequential([
    pretrained_model
])

#download image from url
# fire 1
#imag1_url = "data:image/jpeg;base64,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"

#img1 = wget.download(imag1_url, "test_images/imag1.jpg")


 #show images
#image.open(imag1)


###upload image by tensorflow###

HEIGHT = WIDTH = 224 # fix size of images

#upload images by load_img()
image_one = tf.keras.preprocessing.image.load_img("test_images/img1.jpg", target_size=(HEIGHT, WIDTH))

image_one = tf.keras.preprocessing.image.img_to_array(image_one)

print("image shape initial : ", image_one.shape)


image_two = tf.keras.preprocessing.image.load_img("test_images/img2.jpg", target_size=(HEIGHT, WIDTH))

image_two = tf.keras.preprocessing.image.img_to_array(image_two)

print("image shape initial : ", image_two.shape)


image_three = tf.keras.preprocessing.image.load_img("test_images/img3.jpg", target_size=(HEIGHT, WIDTH))

image_three = tf.keras.preprocessing.image.img_to_array(image_three)

print("image shape initial : ", image_three.shape)


image_four = tf.keras.preprocessing.image.load_img("test_images/img4.jpg", target_size=(HEIGHT, WIDTH))

image_four = tf.keras.preprocessing.image.img_to_array(image_four)

print("image shape initial : ", image_four.shape)

#Data normalization
image_one = image_one/255.0
image_two = image_two/255.0
image_three = image_three/255.0
image_four = image_four/255.0



#Model prediction
def predict_func(image, model):
    image = tf.expand_dims(image, axis=0)#Expand a dimension
    print("image shape +1 dimension : ", image.shape)

    results = model.predict(image) # predict model
    print("result shape : ", results.shape)

    #download imagenet file
    label_file = tf.keras.utils.get_file('labels.txt', 'https://storage.googleapis.com/download.tensorflow.org/data/ImageNetLabels.txt')
    #read labels.txt
    class_names = np.array(open(label_file).read().splitlines())
    print("numbers of labels in ImageNet : ", len(class_names))

    #get the Maximum probability value and the label corresponding
    probilities = tf.nn.softmax(results[0]) # calcul probability values
    highest_prob = np.max(probilities) # get the max value
    label = class_names[np.argmax(probilities)]
    print("The maximum probability value predicted by the model is: %.2f%%" % (highest_prob*100))
    print("The largest categorie predicted by the model is : ", label)

    #show the picture and prediction
    plt.imshow(np.squeeze(image)) # attention! Shrink one dimension now, from (1,224,224,3) to (224,224,3)
    plt.axis('off')
    plt.title(label)
    plt.show()

#Make predictions on the first picture
predict_func(image_four, model)